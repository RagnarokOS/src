# This Makefile automatically generated by configure.

include ${TOPDIR}/usr/share/mk/progs.mk

CC =		cc
CFLAGS =	-g ${O_FLAG} -DEMACS -DVI -w -D_GNU_SOURCE ${HARDENING_CPPFLAGS} ${HARDENING_CFLAGS}
LDFLAGS =	${HARDENING_LDFLAGS}

PREFIX =	
BINDIR =	/bin
MANDIR =	/usr/share/man

PROG =	ksh
OBJS =	alloc.o asprintf.o c_ksh.o c_sh.o c_test.o c_ulimit.o edit.o \
	emacs.o eval.o exec.o expr.o history.o io.o jobs.o lex.o mail.o \
	main.o misc.o path.o shf.o syn.o table.o trap.o tree.o tty.o var.o \
	version.o vi.o confstr.o reallocarray.o siglist.o signame.o \
	strlcat.o strlcpy.o strtonum.o unvis.o vis.o issetugid.o

all: ${PROG}

${PROG}: ${OBJS}
	${CC} ${LDFLAGS} -o ${PROG} ${OBJS}  -lcurses ${LIBS}

install:
	install -d ${DESTDIR}${BINDIR}
	install -d -m 755 -o root -g 0 ${DESTDIR}/etc/skel
	install -d ${DESTDIR}${MANDIR}/man1
	install -c -s -m 755 ${PROG} ${DESTDIR}${BINDIR}
	install -c -m 644 ${PROG}.1 ${DESTDIR}${MANDIR}/man1
	install -c -m 644 -o root -g 0 ksh.kshrc ${DESTDIR}/etc
	install -c -m 644 .kshrc ${DESTDIR}/etc/skel
	@echo "Please add /bin/ksh to /etc/shells"

uninstall:
	rm -f ${DESTDIR}${BINDIR}/${PROG}
	rm -f ${DESTDIR}${MANDIR}/man1/${PROG}.1

test:
	echo "No tests"

clean:
	rm -f ${PROG} ${OBJS}

#distclean: clean
#	rm -f Makefile pconfig.h *.core
