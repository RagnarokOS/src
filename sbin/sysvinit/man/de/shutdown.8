'\" -*- coding: UTF-8 -*-
.\" Copyright (C) 1998-2003 Miquel van Smoorenburg.
.\"
.\" This program is free software; you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License as published by
.\" the Free Software Foundation; either version 2 of the License, or
.\" (at your option) any later version.
.\"
.\" This program is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public License
.\" along with this program; if not, write to the Free Software
.\" Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
.\"
.\"{{{}}}
.\"{{{  Title
.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH SHUTDOWN 8 "12. November 2003" "sysvinit " Linux\-Systemverwaltungshandbuch
.\"}}}
.\"{{{  Name
.SH BEZEICHNUNG
.\"}}}
.\"{{{  Synopsis
shutdown \- das System herunterfahren
.SH ÜBERSICHT
.\"}}}
.\"{{{  Description
\fB/sbin/shutdown\fP [\fB\-akrhPHfFncqQ\fP] [\fB\-t\fP \fISekunden\fP] \fIZeit\fP
[\fIWarnmeldung\fP]
.SH BESCHREIBUNG
.\"}}}
.\"{{{  Options
\fBshutdown\fP fährt das System auf sichere Art herunter. Alle angemeldeten
Benutzer werden benachrichtigt, dass das System herunterfährt und
\fBlogin\fP(1) wird blockiert. Es ist möglich, das System sofort
herunterzufahren oder nach einer angegebenen Verzögerung. Alle Prozesse
werden zuerst mit dem Signal \fBSIGTERM\fP benachrichtigt, dass das System
herunterfährt. Dies gibt Programmen wie \fBvi\fP(1) die Zeit, die bearbeitete
Datei zu speichern, E\-Mail\- und News\-Verarbeitungsprogrammen eine
Möglichkeit, sich sauber zu beenden usw. \fBshutdown\fP erledigt seinen
Auftrag, indem es dem \fBinit\fP signalisiert und bittet, den Runlevel zu
ändern. Zum Anhalten des Systems wird der Runlevel \fB0\fP verwandt, Runlevel
\fB6\fP wird zum Neustart des Systems verwandt und Runlevel \fB1\fP bringt das
System in einen Zustand, in dem administrative Aufgaben durchgeführt werden
können; dies ist die Vorgabe, falls weder der Schalter \fB\-h\fP noch \fB\-r\fP an
\fBshutdown\fP übergeben werden. Um zu sehen, welche Aktionen beim Anhalten
oder Neustarten durchgeführt werden, lesen Sie die entsprechenden Einträge
für diese Runlevel in der Datei \fI/etc/inittab\fP.
.SH OPTIONEN
.\"{{{  -a
.IP \fB\-a\fP
.\"}}}
.\"{{{  -k
Verwendet \fI/etc/shutdown.allow\fP.
.IP \fB\-k\fP
.\"}}}
.\"{{{  -r
Fährt nicht wirklich herunter, sondern sendet lediglich Warnmeldungen an
alle.
.IP \fB\-r\fP
.\"}}}
.\"{{{  -h
Startet nach dem Herunterfahren neu.
.IP \fB\-h\fP
.\"}}}
.\"{{{  -P
Hält das System nach dem Herunterfahren an oder schaltet es aus. Wird
normalerweise mit den Schaltern \fB\-P\fP oder \fB\-H\fP verwandt, abhängig davon,
ob der Rechner ausgeschaltet oder einfach das Betriebssystem angehalten
werden soll.
.IP \fB\-P\fP
.\"}}}
.\"{{{  -H
Modifikator des Schalters \fB\-h\fP. Halt\-Aktion bedeutet das Ausschalten. Muss
mit dem Schalter \fB\-h\fP verwandt werden.
.IP \fB\-H\fP
.\"}}}
.\"{{{  -f
Modifikator des Schalters \fB\-h\fP. Halt\-Aktion bedeutet das Anhalten oder
Übergeben an ein Systemstartprogramm auf Systemen, die das
unterstützten. Muss mit dem Schalter \fB\-h\fP verwandt werden. Halten wird oft
dazu verwandt, den Herunterfahrprozess zu durchlaufen und die Ausgabe auf
dem Bildschirm zur Fehlersuche zu belassen. Oder wenn der Benutzer möchte,
dass das Betriebssystem anhält, aber der Rechner nicht ausgeschaltet werden
soll. Um das System am Ende der Herunterfahrsequenz auszuschalten, verwenden
Sie stattdessen den Modifikator \fB\-P\fP.
.IP \fB\-f\fP
.\"}}}
.\"{{{  -F
Überspringt \fBfsck\fP(8) beim Neustart.
.IP \fB\-F\fP
.\"}}}
.\"{{{  -n
Erzwingt \fBfsck\fP(8) beim Neustart.
.IP \fB\-n\fP
.\"}}}
.\"{{{  -c
[VERALTET] Ruft \fBinit\fP(8) für das Herunterfahren nicht auf, sondern führt
dies selbst durch. Die Verwendung dieser Option wird missbilligt und ihre
Ergebnisse sind nicht immer das, was Sie erwarten.
.IP \fB\-c\fP
.\"{{{  -q
Bricht ein wartendes Herunterfahren ab. (\fBshutdown now\fP wartet nicht mehr.)
Bei dieser Option kann natürlich kein Zeitargument mehr angegeben werden,
aber Sie können eine erklärende Meldung als Argumente auf der Befehlszeile
angeben, die an alle Benutzer gesandt wird.
.IP \fB\-q\fP
.\"{{{  -Q
Reduziert die Anzahl an Warnungen, die \fBshutdown\fP anzeigt. Normalerweise
zeigt \fBshutdown\fP alle 15 Minuten eine Warnung und dann jede Minute in den
letzten 10 Minuten des Herunterzählens, bis die angegebene \fIZeit\fP erreicht
ist. Wenn \fB\-q\fP angegeben ist, warnt \fBshutdown\fP nur in
60\-Minuten\-Intervallen bis zur 10\-Minuten\-Grenze, bei der 5\-Minuten\-Grenze
und wenn das Herunterfahren tatsächlich passiert.
.IP \fB\-Q\fP
.\"}}}
.\"{{{  -t sec
Reduziert die Warnungen vor dem Herunterfahren. Normalerweise zeigt
\fBshutdown\fP alle 15 Minuten und dann jede Minute in den letzten 10 Minuten
beim Herunterzählen, bis die angegebene \fIZeit\fP erreicht wurde, Warnungen
an. Wenn \fB\-Q\fP angegeben wurde, dann warnt \fBshutdown\fP nur, wenn der
Herunterfahrprozess tatsächlich passiert. Alle anderen Warnungsintervalle
werden unterdrückt.
.IP "\fB\-t\fP \fISekunden\fP"
.\"}}}
.\"{{{  time
Weist \fBinit\fP(8) ab, \fISekunden\fP zwischen dem Senden der Warnung
(\fBSIGTERM\fP) und dem Tötensignal (\fBSIGKILL\fP) zu warten, bevor in einen
anderen Runlevel gewechselt wird. Die Standardzeit zwischen diesen zwei
Signalen, falls kein Wert angegeben wird, ist drei Sekunden. Warnung: Wenn
\fBshutdown\fP \fBinit\fP(8) zur Durchführung des Herunterfahrens aufruft (das
Vorgabeverhalten), prüft \fBinit\fP(8), ob sich alle Prozesse beendet haben und
beendet dieses Warten frühzeitig, sobald sich alle Kindprozesse beendet
haben. Wenn \fBshutdown\fP mit dem Schalter \fB\-n\fP aufgerufen wird, wartet es
vollständig die angegebene Zeit (oder drei Sekunden), selbst falls sich alle
Prozesse beendet haben.
.IP \fIZeit\fP
.\"}}}
.\"{{{  warning-message
Gibt den Zeitpunkt des Herunterfahrens an.
.IP \fIWarnmeldung\fP
.\"}}}
Gibt die an alle Benutzer zu sendende Meldung an.
.PP
Das Argument \fIZeit\fP kann in verschiedenen Formaten angegeben werden. Zuerst
kann es eine absolute Zeit im Format \fIhh:mm\fP sein, wobei \fIhh\fP die Stunde
(mit einer oder zwei Ziffern) und \fImm\fP die Minute der Stunde ist (zwei
Ziffern). Zweitens kann sie im Format \fB+\fP\fIm\fP vorliegen, wobei \fIm\fP die
Anzahl der zu wartenden Minuten ist. Drittens kann sie im Format
\fB+\fP\fIhh:mm\fP angegeben werden, wobei \fIhh:mm\fP die Anzahl der zu wartenden
Stunden und Minuten ist. Das Wort \fBnow\fP ist ein Alias für \fB+0\fP.
.PP
Falls \fBshutdown\fP mit einer Verzögerung aufgerufen wird, dann erstellt es
die Hinweisdatei \fI/etc/nologin\fP. Diese führt bei Programmen wie \fBlogin\fP(1)
dazu, dass keine neuen Benutzeranmeldungen mehr möglich sind. Diese Datei
wird fünf Minuten vor Beginn der Herunterfahrsequenz angelegt. \fBshutdown\fP
entfernt diese Datei, falls es vor dem Signalisieren von \fBinit\fP(8) beendet
wird (d.h. es abgebrochen wurde oder irgendetwas schief lief). Es entfernt
sie auch, bevor \fBinit\fP(8) zum Ändern des Runlevels aufgerufen wird.
.PP
Der Schalter \fB\-f\fP bedeutet »schneller Neustart«. Dies erstellt nur eine
Hinweisdatei \fI/fastboot\fP, die vom System überprüft werden kann, wenn es
wieder hochkommt. Die Systemstart\-Rc\-Dateien (Konfigurationsdateien) können
prüfen, ob diese Datei vorhanden ist und entscheiden, \fBfsck\fP(8) nicht
auszuführen, da das System korrekt heruntergefahren wurde. Danach sollte der
Systemstartprozess \fI/fastboot\fP entfernen.
.PP
Der Schalter \fB\-F\fP bedeutet »Fsck erzwingen« (Dateisystemüberprüfung
erzwingen)). Dies erstellt nur eine Hinweisdatei \fI/forcefsck\fP, die vom
System überprüft werden kann, wenn es wieder hochkommt. Die
Systemstart\-Rc\-Dateien (Konfigurationsdateien) können prüfen, ob diese Datei
vorhanden ist und entscheiden, \fBfsck\fP(8) mit einem besonderen »force«\-
(Zwingen\-)Schalter aufzurufen, so dass selbst korrekt ausgehängte
Dateisysteme überprüft werden. Danach sollte der Systemstartprozess
\fI/forcefsck\fP entfernen.
.PP
.\"}}}
.\"{{{  Files
Der Schalter \fB\-n\fP veranlasst \fBshutdown\fP, \fBinit\fP(8) nicht aufzurufen,
sondern alle laufenden Prozesse selbst zu beenden. Dann wird \fBshutdown\fP die
Kontigentierung, Buchführung und das Auslagern beenden und alle Dateisysteme
aushängen.
.SH ZUGRIFFSKONTROLLE
\fBshutdown\fP kann von \fBinit\fP(8) aufgerufen werden, wenn die magische
Tastenkombination \fBSTRG\-ALT\-ENTF\fP gedrückt wird, indem ein geeigneter
Eintrag in \fI/etc/inittab\fP erstellt wird. Das bedeutet, dass jeder, der
physischen Zugriff auf die Tastatur an der Konsole hat, das System
herunterfahren kann. Um dies zu vermeiden, kann \fBshutdown\fP prüfen, ob ein
autorisiert Benutzer an einer der virtuellen Konsolen angemeldet ist. Falls
\fBshutdown\fP mit dem Argument \fB\-a\fP aufgerufen wird (fügen Sie dies zum
Aufruf von Shutdown in \fI/etc/inittab\fP hinzu), dann prüft es, ob die Datei
\fI/etc/shutdown.allow\fP vorhanden ist. Es kann dann die Anmeldenamen in der
Datei mit der Liste der auf einer virtuellen Konsole angemeldeten Leute
vergleichen (aus \fI/var/run/utmp\fP). Nur wenn einer dieser autorisiert
Benutzer \fBoder root\fP angemeldet ist, wird es fortfahren. Andernfalls gibt
es die Meldung
.sp 1
.nf
\fBshutdown: no authorized users logged in\fP
.fi
.sp 1
auf der (physischen) Systemkonsole aus. Das Format von
\fI/etc/shutdown.allow\fP ist ein Benutzername pro Zeile. Leere Zeilen und
Kommentarzeilen (denen ein \fB#\fP vorangestellt ist) sind erlaubt. Derzeit ist
die Datei auf 32 Benutzer beschränkt.
.sp 1
Beachten Sie, dass das Argument \fB\-a\fP ignoriert wird, falls
\fI/etc/shutdown.allow\fP nicht vorhanden ist.
.SH "ANHALTEN ODER AUSSCHALTEN"
Die Option \fB\-H\fP setzt nur die Umgebungsvariable \fBINIT_HALT\fP von \fBinit\fP
auf \fBHALT\fP und die Option \fB\-P\fP setzt diese Variable auf \fBPOWEROFF\fP. Das
Skript (normalerweise \fI/etc/init.d/halt\fP), das das Programm \fBhalt\fP(8) als
letzte Sache in der Herunterfahrsequenz aufruft, sollte diese
Umgebungsvariable prüfen und dann das Programm \fBhalt\fP(8) mit den richtigen
Optionen aufrufen, damit diese Optionen tatsächlich wirksam werden.
.SH DATEIEN
.nf
/fastboot
/etc/inittab
/etc/init.d/halt
/etc/init.d/reboot
/etc/shutdown.allow
.fi
.\"}}}
.SH ANMERKUNGEN
Viele Benutzer vergessen, das Argument \fIZeit\fP anzugeben und sind dann von
der Fehlermeldung von \fBshutdown\fP irritiert. Das Argument \fIZeit\fP ist
verpflichtend: in 90% aller Fälle wird das Argument das Wort \fBnow\fP sein.
.PP
\fBinit\fP(8) kann nur im Konsolen\-Modus STRG\-ALT\-ENTF abfangen und \fBshutdown\fP
starten. Falls auf dem System das X\-Window\-System läuft, verarbeitet der
X\-Server alle Tastatureingaben. Einige X\-Umgebungen ermöglichen es,
STRG\-ALT\-ENTF abzufangen, aber was dann genau passiert, hängt von der
Umgebung ab.
.PP
.\"{{{  Author
\fBshutdown\fP wurde nicht für die Setuid\-Berechtigung
entwickelt. \fI/etc/shutdown.allow\fP findet nicht heraus, wer Shutdown
ausführt, es prüft nur, wer derzeit auf einer der Konsolen angemeldet ist.
.SH AUTOR
.\"}}}
.\"{{{  See also
.MT miquels@\:cistron\:.nl
Miquel van Smoorenburg
.ME
.SH "SIEHE AUCH"
\fBfsck\fP(8), \fBinit\fP(8), \fBhalt\fP(8), \fBpoweroff\fP(8), \fBreboot\fP(8)
.\"}}}
