#!/usr/bin/make -f

DEB_BUILD_MAINT_OPTIONS := hardening=+all
DEB_CFLAGS_MAINT_APPEND := -fPIC -Wall -flto=thin $(shell getconf LFS_CFLAGS)
DEB_LDFLAGS_MAINT_APPEND = -flto=thin -Wl,-O2
DPKG_EXPORT_BUILDFLAGS  := 1

include /usr/share/dpkg/buildflags.mk

include /usr/share/dpkg/architecture.mk

ifneq ($(DEB_HOST_GNU_TYPE),$(DEB_BUILD_GNU_TYPE))
  export CC = $(DEB_HOST_GNU_TYPE)-gcc
else
  export CC = clang
endif

%:
	dh "$@"

override_dh_auto_clean:
	# Don't try to run make clean on unpatched version of Makefile
	! grep -q DEBIAN Makefile || dh_auto_clean

override_dh_installchangelogs:
	dh_installchangelogs -a debian/EXT/ChangeLog
