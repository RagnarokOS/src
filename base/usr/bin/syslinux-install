#!/bin/ksh

# Script to quickly install/configure syslinux
# $Ragnarok: syslinux-install,v 1.3 2024/08/12 14:20:33 lecorbeau Exp $

DEV=$1
RUUID=$(blkid -s UUID -o value "$DEV")
VERSION=$(lsb_release -r 2>/dev/null | awk '{ print $2 }')
CODENAME=$(lsb_release -c 2>/dev/null | awk '{ print $2 }')

mkdir -p /boot/syslinux
extlinux --install /boot/syslinux
dd bs=440 count=1 conv=notrunc if=/usr/lib/syslinux/mbr/mbr.bin of="${DEV}"
sed -i "s/@ROOTUUID@/$RUUID/g" /boot/syslinux.cfg
sed -i "s/@VERSION@/$VERSION/g" /boot/syslinux.cfg
sed -i "s/@CODENAME@/$CODENAME/g" /boot/syslinux.cfg
